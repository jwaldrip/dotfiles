#! /bin/bash
date=`date`
lwd=$PWD
cd ~

# Commit Changes
git add -A
git commit -m "dotfiles update on $date"

# Commit submodules
git submodule foreach git checkout master
git submodule foreach git pull origin master
git submodule foreach git add -A
git submodule foreach git commit -am "dotfiles update on $date"
git submodule foreach git push origin master

# Pull updates
git pull origin master

# Bundle the brew
brew bundle

# Update the bundle
rm -f Brewfile
brew bundle dump

# Commit Changes
git add -f Brewfile
git commit -m "Brewfile update on $date"

git push origin master
cd $lwd
